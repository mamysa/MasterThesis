\documentclass[mscthesis, 11pt]{usiinfthesis}
\usepackage{lipsum}
\setlength{\parindent}{0em}
\setlength{\parskip}{0.5em}


\usepackage{listings}

\graphicspath{{figures/}}
%\usepackage{pythonhighlight}

\lstdefinelanguage{algebra}
{morekeywords={import,sort,constructors,observers,transformers,axioms,if,
else,end},
sensitive=false,
morecomment=[l]{//s},
}

\lstset{language=python,linewidth=0.95\linewidth,breaklines=true,numbers=left, 
basicstyle=\ttfamily,numberstyle=\tiny,escapeinside={//*}{\^^M},
mathescape=true}

\newcommand{\PatternSequence}{$PatternSequence(p_0, p_1, ..., p_n)$ }
\newcommand{\Repeat}{$Repeat(p)$ }
\newcommand{\Nt}{$Nt(nt, s)$ }
\newcommand{\BuiltInPattern}{$BuiltInPattern(t, s)$ }
\newcommand{\InHolePattern} {$InHole(p_1, p_2)$ }
\newcommand{\LiteralPattern}{$Literal(l, v)$ }
\newcommand{\UnresolvedSymbol}{$UnresolvedSymbol(s)$ }
\newcommand{\CheckConstraint}{$CheckConstraint(s_1, s_2)$ }

\newcommand{\TermSequence}{\lstinline[mathescape]!TermSequence($t_1$: TermTemplate, ..., $t_n$: TermTemplate)! } 
\newcommand{\TermRepeat}{\lstinline[mathescape]!Repeat($t$: TermTemplate)! } 
\newcommand{\PatternVariable}{\lstinline[mathescape]!PatternVariable($s$: string)! } 
\newcommand{\TermInHole}{\lstinline[mathescape]!InHole($p_1$: TermTemplate, $p_2$: TermTemplate)! } 
\newcommand{\TermLiteral}{\lstinline[mathescape]!Literal($l$: TermLiteralKind, $v$: Any)! } 
\newcommand{\TermUnresolvedSymbol}{\lstinline[mathescape]!UnresolvedSymbol($s$: string)! } 
\newcommand{\PythonCall}{\lstinline[mathescape]!PythonCall($m$: PyCallMode, $t_1$: TermTemplate, ..., $t_n$: TermTemplate)! } 
\newcommand{\ApplyMetafunction}{\lstinline[mathescape]!ApplyMetafunction($n$: string, $t$: TermTemplate)! } 


\newcommand{\DefineLanguage}{\lstinline[mathescape]!DefineLanguage($name$: string, \[$nt_1, ..., nt_n$\]: NtDefinition)! } 
\newcommand{\NtDefinition}{\lstinline[mathescape]!NtDefinition($nt$: Nt, \[$p_1, ..., p_n$\]: Pattern)! } 

\newcommand{\DefineMetafunction}{\lstinline[mathescape]!DefineMetafunction($name$: string, $domain$: Pattern, $codomain$: Pattern, \[$c_1, ..., c_n$\]: MetafunctionCase)! } 
\newcommand{\MetafunctionCase}{\lstinline[mathescape]!MetafunctionCase($p$: Pattern, $t$: Term)! } 

\newcommand{\DefineReductionRelation}{\lstinline[mathescape]!DefineReductionRelation($name$: string, $languagename$: string, $domain$: Pattern?, \[$r_1, ..., r_n$\]: ReductionCase)! } 
\newcommand{\ReductionCase}{\lstinline[mathescape]!ReductionCase($p$: Pattern, $t$: Term, $n$: string)! } 

\newcommand{\Match}{\lstinline[mathescape]!Match($[(s_1, t_1), ..., (s_n, t_n)]$: Tuple(string, Term)?)! }
\newcommand{\RedexMatchAssertEqual}{\lstinline[mathescape]!RedexMatchAssertEqual($l$: string, $p$: Pattern, $t$: Term, $[e_1, ..., e_n]$: Term)! } 

\newcommand{\TermLetAssertEqual}{\lstinline[mathescape]!TermLetAssertEqual([$(v_1, n_1, t_1), ..., (v_n, t_n, t_n)$]: Tuple(string, natural, Term)?, $p$: Pattern, $t$: Term, $e$: Term)! }
\newcommand{\ApplyReductionRelationAssertEqual}{\lstinline[mathescape]!ApplyReductionRelationAssertEqual($r$: string, $t$: Term, $[e_1, ..., e_n]$: Term?)! }


\newcommand{\Visit}[1]{$\texttt{visit}($#1$)$ }

\title{My Dissertation - A very long title\\ which runs over two
  lines} %compulsory
\specialization{Dependable Distributed Systems}%optional
\subtitle{Subtitle: Reinventing the World} %optional 
\author{Master Student} %compulsory
\begin{committee}
\advisor{Prof.}{Student's}{Advisor} %compulsory
\coadvisor{Prof.}{Student's}{Co-Advisor}{} %optional
\end{committee}
\Day{Yesterday} %compulsory
\Month{September} %compulsory
\Year{2010} %compulsory, put only the year
\place{Lugano} %compulsory

\dedication{To my beloved} %optional
\openepigraph{Someone said \dots}{Someone} %optional

%\makeindex %optional, also comment out \theindex at the end

\begin{document}

\maketitle %generates the titlepage, this is FIXED

\frontmatter %generates the frontmatter, this is FIXED

\begin{abstract}
This is a very abstract abstract. 
\end{abstract}


\begin{acknowledgements}
	Hi Mom!
\end{acknowledgements}

\tableofcontents 
\listoffigures %optional
\listoftables %optional

\mainmatter

\input{chapters/01-introduction.tex}
\input{chapters/02-features-of-pltredex.tex}
\input{chapters/03-pypy-and-rpython.tex}
\input{chapters/04-PyPltRedex-runtime.tex}
\input{chapters/05-compiletime-racket-representation.tex}
\input{chapters/06-pattern-matching.tex}
\input{chapters/07-codegen.tex}
\input{chapters/08-toplevel-forms.tex}
\input{chapters/09-testing-evaluation.tex}
\input{chapters/10-conclusion.tex}


\chapter{ListListing example}
\lstset{language=algebra,linewidth=0.95\linewidth,breaklines=true,numbers=left,
basicstyle=\ttfamily,numberstyle=\tiny,escapeinside={//*}{\^^M},
mathescape=true}
\begin{lstlisting}
import IntSpec, ItemSpec;

sort cart; //*\label{sort}

constructors //*\label{begin-sig}
create() $\longrightarrow$ cart;
insert(cart, item) $\longrightarrow$ cart;
observers
amount(cart) $\longrightarrow$ int;
transformers
delete(cart, item) $\longrightarrow$ cart; //*\label{end-sig}

axioms //*\label{begin-axioms}
forall c: cart, i, j: item 

amount(create()) $=$ 0; //*\label{begin-amount}
amount(insert(c,i)) $=$ amount(c) $+$ price(i); //*\label{end-amount}
delete(create(),i) $=$ create(); //*\label{begin-delete}
delete(insert(c,i),j) $=$
if (i =$\:$= j) c
else insert(delete(c,j),i); //*\label{end-axioms}
end
\end{lstlisting}



\backmatter

\chapter{Glossary} %optional

%\bibliographystyle{alpha}
%\bibliographystyle{dcu}
\bibliographystyle{plainnat}
\bibliography{biblio}

%\cleardoublepage
%\theindex %optional, use only if you have an index, must use
	  %\makeindex in the preamble
\lipsum

\end{document}
